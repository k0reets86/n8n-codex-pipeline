# Пошаговая настройка (SUPER‑подробно)

## Часть 1. Создаём репозиторий на GitHub
1. Откройте GitHub → войдите в аккаунт.
2. Нажмите **+** (в правом верхнем углу) → **New repository**.
3. В поле **Repository name** введите: `n8n-codex-pipeline` (или своё).
4. Выберите **Private** (рекомендуется) либо **Public**.
5. **НЕ** ставьте галочку про шаблоны — мы сами загрузим файлы.
6. Нажмите **Create repository**.

## Часть 2. Загружаем файлы (ZIP)
1. Скачайте ZIP‑архив из чата и распакуйте его на компьютер (получится папка `n8n-codex-pipeline-pro/`).
2. В вашем пустом репозитории на GitHub нажмите **Add file** → **Upload files**.
3. Откройте проводник (Finder/Explorer), выделите **всё содержимое** папки (ВСЕ файлы и папки внутри), и **перетащите** в окно GitHub.
4. Прокрутите вниз и нажмите зелёную кнопку **Commit changes**. Готово, файлы загружены.

## Часть 3. Включаем GitHub Actions и настраиваем секреты
1. Откройте вкладку **Actions** в репозитории. Если видите «Workflows aren’t being run on this repository» — нажмите кнопку **I understand… Enable**.
2. Откройте **Settings** → слева **Secrets and variables** → **Actions** → **New repository secret**. Создайте **три** секрета:
   - `N8N_BASE_URL` → например: `https://k0reets.app.n8n.cloud` (без завершающего `/`)
   - `N8N_API_KEY`  → ваш персональный API‑ключ из n8n:
     - откройте ваш n8n → шестерёнка **Settings** → **Personal Access Tokens / API Keys** → **Create** → скопируйте токен.
   - `N8N_TEST_WEBHOOK_URL` → полный URL вашего тестового вебхука, например:
     `https://k0reets.app.n8n.cloud/webhook/codex-smoke`

## Часть 4. Первый запуск деплоя
1. Вернитесь на главную репозитория → откройте любой файл (например, `README.md`), нажмите **✏️** (карандаш), добавьте пустую строку и нажмите **Commit changes**.
2. Перейдите на вкладку **Actions** → откройте джоб **Deploy n8n workflows**. Дождитесь зелёной галочки ✓.
3. Если всё ОК — в вашем n8n появится воркфлоу **“Example – Codex Smoke Webhook”** и будет **Active**.

## Часть 5. Тест вебхука (вручную)
**Вариант с `curl` (любой терминал):**
```bash
curl -X POST https://<ВАШ_ДОМЕН>.app.n8n.cloud/webhook/codex-smoke \
  -H 'Content-Type: application/json' \
  --data '{"hello":"world"}'
```
> В ответ должно прийти что-то вроде: `{ "status":"ok", "echo": { "hello":"world", ... } }`.

## Частые ошибки
- **Deploy упал на шаге “Validate”** → в файлах `workflows/*.json` есть синтаксическая ошибка или неправильная структура. Откройте лог и исправьте.
- **Deploy упал на шаге “Deploy to n8n”** → проверьте `N8N_BASE_URL` и `N8N_API_KEY` (правильный домен? токен активен?). Убедитесь, что тариф/инстанс позволяет REST API.
- **Deploy упал на шаге “Smoke test”** → проверьте, что воркфлоу активен и URL вебхука корректен.

## Как подключить “Кодекс” (ChatGPT) для автогенерации PR
Дайте ИИ такой промпт (пример):
```
Ты — инженер по n8n. В репозитории workflows/*.json лежат воркфлоу. 
Сгенерируй новый файл workflows/my_flow.json под ТЗ ниже. 
Требования: валидный JSON, есть Webhook-триггер с POST и path=/my-flow, подключены нужные узлы, креды не коммитим. 
Обнови README раздел «Как протестировать». Оформи Pull Request.
ТЗ: <ваше описание>
```
После мерджа в `main` — деплой и тест запустятся автоматически.
